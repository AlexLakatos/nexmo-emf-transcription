(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3075"],{"087b":function(t,a,l){"use strict";l.r(a);var s=function(){var t=this,a=t.$createElement,l=t._self._c||a;return l("div",[t.loading?l("div",[l("h1",{staticClass:"mdl-typography--display-1"},[t._v("Loading...")]),l("div",{staticClass:"mdl-progress mdl-js-progress mdl-progress__indeterminate"})]):t._e(),t.showDialog?l("div",{staticClass:"mdl-dialog"},[l("h4",{staticClass:"mdl-dialog__title"},[t._v("Something is wrong with the media stream!")]),t._m(0),l("div",{staticClass:"mdl-dialog__actions"},[l("button",{staticClass:"mdl-button close",attrs:{type:"button"},on:{click:t.startStreaming}},[t._v("Restart")]),l("button",{staticClass:"mdl-button close",attrs:{type:"button"},on:{click:function(a){t.showDialog=!t.showDialog}}},[t._v("Ignore")])])]):t._e(),t.loading?t._e():l("div",{staticClass:"audio-controls mdl-grid"},[t._m(1),t.callStats&&t.streaming?l("div",{staticClass:"mdl-cell mdl-cell--8-col mdl-cell--12-col-phone mdl-card mdl-shadow--2dp"},[l("div",{staticClass:"'mdl-card__title mdl-card--expand"},[l("h2",{staticClass:"mdl-card__title-text"},[t._v("Audio Quality: "+t._s(t.mos))])]),l("div",{staticClass:"mdl-card__supporting-text mdl-grid"},[l("div",{staticClass:"mdl-cell mdl-cell--6-col mdl-cell--12-col-phone"},[t.callStats.outbound_rtp_audio_0?l("table",{staticClass:"mdl-data-table mdl-js-data-table mdl-data-table--selectable mdl-shadow--2dp"},[t._m(2),l("tbody",t._l(Object.keys(t.callStats.outbound_rtp_audio_0),function(a){return l("tr",{key:a},[l("td",[t._v(t._s(a))]),l("td",[t._v(t._s(t.callStats.outbound_rtp_audio_0[a]))])])}))]):t._e()]),l("div",{staticClass:"mdl-cell mdl-cell--6-col mdl-cell--12-col-phone"},[t.callStats.outbound_rtcp_audio_0?l("table",{staticClass:"mdl-data-table mdl-js-data-table mdl-data-table--selectable mdl-shadow--2dp"},[t._m(3),l("tbody",t._l(Object.keys(t.callStats.outbound_rtcp_audio_0),function(a){return l("tr",{key:a},[l("td",[t._v(t._s(a))]),l("td",[t._v(t._s(t.callStats.outbound_rtcp_audio_0[a]))])])}))]):t._e()])])]):t._e(),t.streaming?l("div",{staticClass:"mdl-cell mdl-cell--4-col mdl-cell--12-col-phone mdl-card mdl-shadow--2dp streaming"},[l("div",{staticClass:"mdl-grid"},[l("h2",{staticClass:"mdl-cell mdl-cell--12-col mdl-typography--display-1"},[t._v("You're streaming live")]),t._m(4),l("div",{staticClass:"mdl-cell mdl-cell--6-col"},[l("button",{staticClass:"mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored",on:{click:t.stopStreaming}},[l("i",{staticClass:"material-icons"},[t._v("stop")])])])])]):t._e(),t.streaming?t._e():l("div",{staticClass:"not-streaming mdl-cell mdl-cell--12-col mdl-cell--12-col-phone mdl-card mdl-shadow--2dp"},[l("div",{staticClass:"mdl-grid"},[l("h2",{staticClass:"mdl-typography--display-1 mdl-cell mdl-cell--12-col"},[t._v("You're not streaming")]),l("div",{staticClass:"mdl-cell mdl-cell--6-col"},[l("button",{staticClass:"mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored",on:{click:t.startStreaming}},[l("i",{staticClass:"material-icons"},[t._v("play_arrow")])])]),t._m(5)])])])])},e=[function(){var t=this,a=t.$createElement,l=t._self._c||a;return l("div",{staticClass:"mdl-dialog__content"},[l("p",[t._v("\n        Please restart media stream.\n      ")])])},function(){var t=this,a=t.$createElement,l=t._self._c||a;return l("audio",{attrs:{id:"audio",src:""}},[l("source")])},function(){var t=this,a=t.$createElement,l=t._self._c||a;return l("thead",[l("tr",[l("th"),l("th",[t._v("Sent")])])])},function(){var t=this,a=t.$createElement,l=t._self._c||a;return l("thead",[l("tr",[l("th"),l("th",[t._v("Received")])])])},function(){var t=this,a=t.$createElement,l=t._self._c||a;return l("div",{staticClass:"mdl-cell mdl-cell--6-col"},[l("button",{staticClass:"mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored",attrs:{disabled:""}},[l("i",{staticClass:"material-icons"},[t._v("play_arrow")])])])},function(){var t=this,a=t.$createElement,l=t._self._c||a;return l("div",{staticClass:"mdl-cell mdl-cell--6-col"},[l("button",{staticClass:"mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored",attrs:{disabled:""}},[l("i",{staticClass:"material-icons"},[t._v("stop")])])])}],o=(l("7f7f"),l("cadf"),l("551c"),l("097d"),l("bc3a")),i=l.n(o),n=l("e578"),c=l.n(n),d={name:"stage",data:function(){return{conversation:void 0,streaming:!1,showDialog:!1,loading:!0,mos:void 0,callStats:void 0}},created:function(){var t=this;this.$route.params.conversation?this.loginAndGetConversation():i.a.get("https://nexmo-emf-transcription.herokuapp.com/api/data/stages").then(function(a){t.$route.params.conversation=a.data.filter(function(a){if(a.name===t.$route.params.id)return a})[0].id}).then(this.loginAndGetConversation).catch(console.error)},methods:{getConversation:function(t){var a=this;return console.log("*** Logged into app",t),t.on("rtcstats:report",function(t,l){a.mos=t,0===t&&(a.showDialog=!0),a.callStats=l}),t.getConversation(this.$route.params.conversation)},setConversation:function(t){this.conversation=t,this.loading=!1},loginAndGetConversation:function(){var t=this;i.a.get("https://nexmo-emf-transcription.herokuapp.com/api/jwt/stage".concat(this.$route.params.id)).then(function(a){var l=new c.a({debug:!1,rtcstats:{emit_events:!0}}).login(a.data.user_jwt).then(t.getConversation).then(t.setConversation);l.on("disconnect",function(){console.log("disconnect")})}).catch(console.error)},startStreaming:function(){var t=this;this.showDialog=!1,this.conversation.media.enable().then(function(a){var l=document.getElementById("audio");"srcObject"in l?l.srcObject=a:l.src=window.URL.createObjectURL(a),l.onloadedmetadata=function(){l.play(),t.streaming=!0}})},stopStreaming:function(){this.conversation.media.disable();var t=document.getElementById("audio");t.pause(),this.streaming=!1}}},r=d,m=(l("3c02"),l("2877")),u=Object(m["a"])(r,s,e,!1,null,null,null);u.options.__file="Stage.vue";a["default"]=u.exports},"3c02":function(t,a,l){"use strict";var s=l("845f"),e=l.n(s);e.a},"845f":function(t,a,l){}}]);
//# sourceMappingURL=chunk-3075.943ba4d4.js.map